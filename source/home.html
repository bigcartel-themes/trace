{% if errors != blank %}
  <ul class="errors">
    {% for error in errors %}
    <li>{{ error }}</li>
    {% endfor %}
  </ul>
{% endif %}

{% if theme.welcome_image or theme.welcome_message != blank %}
  <div class="home-welcome">
    {% if theme.welcome_image %}<a href="/products"><img class="welcome-image" src="{{ theme.images.welcome_image.url | constrain: 1400,'' }}"></a>{% endif %}
    <div class="welcome-message">
      <h2 class="welcome-header">{{ theme.welcome_message }}</h2>
      <a class="button welcome-button" href="/products" title="Start shopping">Start shopping</a>
    </div>
  </div>
{% endif %}

{% if theme.featured_items_type == 'Categories' %}
  {% if categories.active != blank and theme.featured_items > 0 %}
    <div class="carousel-holder">
      <div class="carousel carousel-main">
        {% for category in categories.active limit:theme.featured_items %}
          {% for product in category.products limit:1 %}
            <div class="carousel-cell">
              <div class="category-image" style="background-image:url('{{ product.image | product_image_url | constrain: 1000,1000 }}');"></div>
              
              <div class="category-name">
                <a href="{{ category.url }}" class="category-text">
                  <div class="category-title">{{ category.name }}</div>
                  <div class="category-subtitle">Shop now</div>
                </a>
              </div>
              
            </div>
          {% endfor %}
          {% assign num_categories = forloop.length %}
        {% endfor %}
      </div>
      <div class="carousel carousel-nav"{% if num_categories == 1 %} style="display:none;"{% endif %}>
        {% for category in categories.active limit:theme.featured_items %}
          <div class="carousel-cell">{{ forloop.index }}</div>
        {% endfor %}
      </div>
    </div>
  {% endif %}
  
{% else %}
  {% if theme.featured_items > 0 %}
    {% get products from products.all limit:theme.featured_items %}
      {% if products != blank %}
        <div class="carousel-holder">
          <div class="carousel carousel-main">
            {% for product in products %}
              <div class="carousel-cell">
                <div class="category-image" style="background-image:url('{{ product.image | product_image_url | constrain: 1000,1000 }}');"></div>
                <div class="category-name">
                  <a href="{{ product.url }}" class="category-text">
                    <div class="category-title">{{ product.name }}</div>
                    <div class="category-subtitle">Shop now</div>
                  </a>
                </div>
              </div>
              {% assign num_products = forloop.length %}
            {% endfor %}
          </div>
          <div class="carousel carousel-nav"{% if num_products == 1 %} style="display:none;"{% endif %}>
            {% for product in products %}
              <div class="carousel-cell">{{ forloop.index }}</div>
            {% endfor %}
          </div>
        </div>
      {% endif %}
    {% endget %}
  {% endif %}
{% endif %}